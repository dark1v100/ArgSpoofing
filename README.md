๐ฏ ููุฏ C ูุชูุฏู: ุฅุฎูุงุก ุงูุฃูุงูุฑ ุงูุญููููุฉ ููุจุฑุงูุฌ ูู Windows

๐ ูู ุชุฑูุฏ ุชุดุบูู ุจุฑูุงูุฌ ุจูุนูููุฉ ูุฒููุฉ ูุชุฎุฏุน ุฃุฏูุงุช ุงููุญุตุ
ูู ูุฐุง ุงููุซุงู ูุณุชุฎุฏู ุฃุณููุจ ุงุญุชุฑุงูู ูุชุดุบูู ุจุฑูุงูุฌ ุจูุนูููุฉ ุธุงูุฑูุฉุ ุจูููุง ูุชู ุชูููุฐ ุฃูุฑ ูุฎุชูู ุชูุงููุง ุฏุงุฎู ุงููุธุงู!

๐งช ุงูููุฑุฉ:
ุชุดุบูู powershell.exe ุจูุนุงูู ูุฒูู ูุธูุฑ ูู Totally Legit Argumentุ ุจูููุง ูุชู ูุนูููุง ุชูููุฐ calc.exe.

๐๏ธ ุงูุฎุทูุงุช ุงูุชูููุฉ:

ุฅูุดุงุก ุงูุนูููุฉ ุจูุถุน ูุนูู CREATE_SUSPENDED.

ุงููุตูู ุฅูู ุงูู PEB ุงูุฎุงุต ุจุงูุนูููุฉ.

ุชุนุฏูู CommandLine.Buffer ุฏุงุฎู RTL_USER_PROCESS_PARAMETERS.

ุงุณุชุฆูุงู ุชุดุบูู ุงูุนูููุฉ ุจุนุฏ ุชุนุฏูู ุงููุนุงูู.

๐ก ุงููุงุฆุฏุฉ ูู ุงูุทุฑููุฉ:

ุฅุฎูุงุก ุงูููุฉ ุงูุญููููุฉ ููุจุฑูุงูุฌ.

ุชุฌุงูุฒ ุฃุฏูุงุช ุงูุชุญููู ู EDR.

ููู ุฃุนูู ูููููุฉ ููููุฉ ุงูุนูููุงุช ูู Windows.

๐ง ุงูููุชุจุงุช ุงููุณุชุฎุฏูุฉ:

c
ูุณุฎ
ุชุญุฑูุฑ
#include <Windows.h>
#include <winternl.h>
๐ ุฃูู ุงูุฏูุงู:

CreateProcessW

NtQueryInformationProcess

ReadProcessMemory

WriteProcessMemory

๐ ุงูููุฏ ูุดุชุบู ูุจุงุดุฑุฉุ ุฏูู ุฃู ูููุงุช ุฎุงุฑุฌูุฉ
โ๏ธ ูุงูู ุงููุดุฑูุน ุฏุงุฎู ููู ูุงุญุฏ ุจูุบุฉ C
โ๏ธ ุชู ุชุฌุฑุจุชู ุนูู Windows 10
โ๏ธ ูููุฏ ููุฎุชุจุฑู ุงูุงุฎุชุฑุงู ูุฃุจุญุงุซ ุงูู Red Team

