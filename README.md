🎯 كود C متقدم: إخفاء الأوامر الحقيقية للبرامج في Windows

📌 هل تريد تشغيل برنامج بمعلومة مزيفة وتخدع أدوات الفحص؟
في هذا المثال نستخدم أسلوب احترافي لتشغيل برنامج بمعلومة ظاهرية، بينما يتم تنفيذ أمر مختلف تمامًا داخل النظام!

🧪 الفكرة:
تشغيل powershell.exe بمعامل مزيف يظهر كـ Totally Legit Argument، بينما يتم فعليًا تنفيذ calc.exe.

🛠️ الخطوات التقنية:

إنشاء العملية بوضع معلق CREATE_SUSPENDED.

الوصول إلى الـ PEB الخاص بالعملية.

تعديل CommandLine.Buffer داخل RTL_USER_PROCESS_PARAMETERS.

استئناف تشغيل العملية بعد تعديل المعامل.

💡 الفائدة من الطريقة:

إخفاء النية الحقيقية للبرنامج.

تجاوز أدوات التحليل و EDR.

فهم أعمق لكيفية هيكلة العمليات في Windows.

🧠 المكتبات المستخدمة:

c
نسخ
تحرير
#include <Windows.h>
#include <winternl.h>
📄 أهم الدوال:

CreateProcessW

NtQueryInformationProcess

ReadProcessMemory

WriteProcessMemory

📁 الكود يشتغل مباشرة، دون أي ملفات خارجية
✔️ كامل المشروع داخل ملف واحد بلغة C
✔️ تم تجربته على Windows 10
✔️ مفيد لمختبري الاختراق وأبحاث الـ Red Team

